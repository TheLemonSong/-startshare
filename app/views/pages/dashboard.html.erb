<div class="content-wrapper">
  <h1 class="hidden">Dashboard</h1>
    <div class="container">
      <br>
      <div class="proj-dashboard">
        <h2>My Projects</h2>
        <br>
        <div class="row">
          <% if @projects.any? %>
            <% @projects.each do |project| %>
              <div class="col-xs-12 col-sm-4">
                  <div class="card">
                    <%= render "projects/card", project: project %>
                  </div>
              </div>
            <% end %>
          <% else %>
            <h3 class="text-center"><%= "You have no projects at the moment" %></h3>
          <% end %>
        </div>
          <div class="create">
            <% if policy(User).create? %>
              <%= link_to "Create a project", new_project_path, class: "btn btn-primary btn-lg" %>
            <% end %>
          </div>
        </div>
        <hr>
        <br>

        <br>
          <h2>Project Applicants</h2>
        <br>

      <!-- APPLICATIONS TO MY PROJECTS -->
      <div class="row">
        <% if @user_applications.empty? %>
          <h3 class="text-center">You have no applicants to review</h3>
        <% else %>
          <% @user_applications.each do |application| %>
            <% if application.status == "pending" || application.status == "accepted"%>
              <!-- card -->
              <div class="application-card">
              <!-- top layer -->
                <div class="application-card-top flex">
                  <!-- left -->
                  <div class="application-card-top-left">
                    <div class="flex-column" style="margin-bottom: 20px;">
                      <h6>APPLICANT :</h6>
                      <%= link_to user_path(application.user) do %>
                        <h3> <%= application.user.first_name + " " + application.user.last_name %> </h3>
                      <% end %>
                    </div>
                    <div class="flex-column" style="margin-bottom: 20px;">
                      <h6>ROLE :</h6>
                      <h3><%= application.role.name %></h3>
                    </div>
                    <div class="flex-column">
                      <h6>PROJECT :</h6>
                      <%= link_to project_path(application.role.project) do %>
                      <h3><%= application.role.project.name %></h3>
                      <% end %>
                    </div>
                  </div>
                  <!-- middle -->
                  <div class="application-card-top-middle flex-center">
                    <div class="status-card">

                      <% if application.status == "pending" %>
                      <%= link_to "Accept", accept_application_path(application), class: "btn btn-primary"%>
                      <%= link_to "Decline", decline_application_path(application), class: "btn btn-warning"%>
                      <% else %>
                      <%= application.status.capitalize %>
                      <% end %>
                    </div>
                  </div>
                  <!-- right -->
                  <div class="application-card-top-right">
                    <%= render "pages/chat", application: application %>
                  </div>
                </div>
              </div>
            <% end %>
          <% end %>
        <% end %>
      </div>
        <hr>
        <br>
      <h2>My Role Applications</h2>
        <br>

      <!-- MY APPLICATIONS -->
      <div class="row">
        <% if current_user.applications.empty? %>
          <h3 class="text-center">You have made no applications</h3>
        <% else %>
          <% @applications.each do |application| %>
            <!-- card -->
            <div class="application-card">
            <!-- top layer -->
              <div class="application-card-top flex">
                <!-- left -->
                <div class="application-card-top-left">
                  <div class="flex-column" style="margin-bottom: 20px;">
                    <h6>ROLE :</h6>
                    <h3><%= application.role.name %></h3>
                  </div>
                  <div class="flex-column">
                    <h6>PROJECT :</h6>
                    <h3><%= application.role.project.name %></h3>
                  </div>
                  <div class="flex-column">
                    <h6>DESCRIPTION :</h6>
                    <h3><%= application.role.description %></h3>
                  </div>
                </div>
                <!-- middle -->
                <div class="application-card-top-middle flex-center">
                  <div class="status-card">
                    <%= application.status.capitalize %>
                  </div>
                </div>
                <!-- right -->
                <div class="application-card-top-right">
                  <%= render "pages/chat", application: application %>
                </div>
              </div>
            </div>
          <% end %>
        <% end %>
      </div>
      <br>
    </div>
</div>
